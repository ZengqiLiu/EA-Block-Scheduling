<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Ea-block-scheduling</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.13.1/application.js' type='text/javascript'></script>
    <link href='./assets/0.13.1/application.css' media='screen, projection, print' rel='stylesheet' type='text/css' />
    <link rel="icon" type="image/png" href="./assets/0.13.1/favicon_yellow.png" />
  </head>

  <body>
    <div id="loading">
      <img src="./assets/0.13.1/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" class="hide">
      <div class="timestamp">Generated <abbr class="timeago" title="2025-04-25T23:31:24-05:00">2025-04-25T23:31:24-05:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent">
      <span class="yellow">
  89.16%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         4.85
       </span>
    </span> hits/line
    )
  </h2>

  <a name="AllFiles"></a>

  <div>
    <b>19</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>452</b> relevant lines,
    <span class="green"><b>403</b> lines covered</span> and
    <span class="red"><b>49</b> lines missed. </span>
    (<span class="yellow">
  89.16%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b1476ae8c4c7df269f972cd2507eef05a222ead5" class="src_link" title="app/controllers/admin_controller.rb">app/controllers/admin_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">10</td>
            <td class="cell--number">4</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#68472b3a551b422be54cd4fd7a9ef9288a2df1af" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">18</td>
            <td class="cell--number">9</td>
            <td class="cell--number">9</td>
            <td class="cell--number">0</td>
            <td class="cell--number">38.78</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#3068302ea59124c2eaead910c9c4d5767478955c" class="src_link" title="app/controllers/block_selections_controller.rb">app/controllers/block_selections_controller.rb</a></td>
            <td class="red strong cell--number t-file__coverage">79.41 %</td>
            <td class="cell--number">72</td>
            <td class="cell--number">34</td>
            <td class="cell--number">27</td>
            <td class="cell--number">7</td>
            <td class="cell--number">1.71</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1744bd46cd4e8aee67df4b1e7e7b0f6dd745175f" class="src_link" title="app/controllers/blocks_controller.rb">app/controllers/blocks_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">87.18 %</td>
            <td class="cell--number">67</td>
            <td class="cell--number">39</td>
            <td class="cell--number">34</td>
            <td class="cell--number">5</td>
            <td class="cell--number">3.67</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#fd7707f9b9d4ef175c11c4df3e1bb6c029a674b8" class="src_link" title="app/controllers/courses_controller.rb">app/controllers/courses_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">89.80 %</td>
            <td class="cell--number">259</td>
            <td class="cell--number">98</td>
            <td class="cell--number">88</td>
            <td class="cell--number">10</td>
            <td class="cell--number">3.33</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ba3e8706daedc3261b2a329430c34ef324a556f7" class="src_link" title="app/controllers/excel_files_controller.rb">app/controllers/excel_files_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">86.96 %</td>
            <td class="cell--number">89</td>
            <td class="cell--number">23</td>
            <td class="cell--number">20</td>
            <td class="cell--number">3</td>
            <td class="cell--number">1.48</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#4ee89e87d84f30fe4bec31e3d8d1c62b24330409" class="src_link" title="app/controllers/pages_controller.rb">app/controllers/pages_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">14</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.57</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f17b9a788ed7e2fd952532270bb4e3b71702ccdd" class="src_link" title="app/controllers/registrations_controller.rb">app/controllers/registrations_controller.rb</a></td>
            <td class="red strong cell--number t-file__coverage">59.46 %</td>
            <td class="cell--number">81</td>
            <td class="cell--number">37</td>
            <td class="cell--number">22</td>
            <td class="cell--number">15</td>
            <td class="cell--number">0.97</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b06eedc52fb7dd610954e20a8c118fa874a7effc" class="src_link" title="app/controllers/schedules_controller.rb">app/controllers/schedules_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">31</td>
            <td class="cell--number">14</td>
            <td class="cell--number">14</td>
            <td class="cell--number">0</td>
            <td class="cell--number">2.14</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#0b4b129d7396ed0cbbd9b51eb7ddbbc8fa68fee3" class="src_link" title="app/controllers/sessions_controller.rb">app/controllers/sessions_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">40</td>
            <td class="cell--number">21</td>
            <td class="cell--number">21</td>
            <td class="cell--number">0</td>
            <td class="cell--number">13.57</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b2da450e91f29cbb10981b98a229a95377807d5b" class="src_link" title="app/controllers/students_controller.rb">app/controllers/students_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">4</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#76579a1868307efbe7ce2cb73de959f0ce2d5114" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">91.67 %</td>
            <td class="cell--number">61</td>
            <td class="cell--number">36</td>
            <td class="cell--number">33</td>
            <td class="cell--number">3</td>
            <td class="cell--number">1.14</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1ebedd0199ef60b64c6fcb59d71a3435b3ff34d7" class="src_link" title="app/helpers/admin_helper.rb">app/helpers/admin_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">2</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f6db2153ee565191c070b0ee3d03cbeb357cfe72" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">32</td>
            <td class="cell--number">6</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0</td>
            <td class="cell--number">28.33</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#24df8333f0932949741d0f4da5dbdd1ebbc5b52d" class="src_link" title="app/helpers/blocks_helper.rb">app/helpers/blocks_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">2</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6a60a409c59d3a0a98e3280d1ad4f05350d186a2" class="src_link" title="app/helpers/courses_helper.rb">app/helpers/courses_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.67 %</td>
            <td class="cell--number">86</td>
            <td class="cell--number">30</td>
            <td class="cell--number">29</td>
            <td class="cell--number">1</td>
            <td class="cell--number">4.33</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#eb01fc174b864de452fa139400b3de723c103dc2" class="src_link" title="app/helpers/excel_files_helper.rb">app/helpers/excel_files_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">6</td>
            <td class="cell--number">4</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.50</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c045af345a201725bfed6c63ed8ab504fab1a86e" class="src_link" title="app/services/file_parser.rb">app/services/file_parser.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.83 %</td>
            <td class="cell--number">105</td>
            <td class="cell--number">63</td>
            <td class="cell--number">61</td>
            <td class="cell--number">2</td>
            <td class="cell--number">8.65</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#207254e2f5a3c3df57a3bcdfc3ee5d5a237cbfa7" class="src_link" title="app/services/user_service.rb">app/services/user_service.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">86.96 %</td>
            <td class="cell--number">48</td>
            <td class="cell--number">23</td>
            <td class="cell--number">20</td>
            <td class="cell--number">3</td>
            <td class="cell--number">0.87</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>


        
          <div class="file_list_container" id="Controllers">
  <h2>
    <span class="group_name">Controllers</span>
    (<span class="covered_percent">
      <span class="yellow">
  86.73%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         4.07
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Controllers"></a>

  <div>
    <b>12</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>324</b> relevant lines,
    <span class="green"><b>281</b> lines covered</span> and
    <span class="red"><b>43</b> lines missed. </span>
    (<span class="yellow">
  86.73%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b1476ae8c4c7df269f972cd2507eef05a222ead5" class="src_link" title="app/controllers/admin_controller.rb">app/controllers/admin_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">10</td>
            <td class="cell--number">4</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#68472b3a551b422be54cd4fd7a9ef9288a2df1af" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">18</td>
            <td class="cell--number">9</td>
            <td class="cell--number">9</td>
            <td class="cell--number">0</td>
            <td class="cell--number">38.78</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#3068302ea59124c2eaead910c9c4d5767478955c" class="src_link" title="app/controllers/block_selections_controller.rb">app/controllers/block_selections_controller.rb</a></td>
            <td class="red strong cell--number t-file__coverage">79.41 %</td>
            <td class="cell--number">72</td>
            <td class="cell--number">34</td>
            <td class="cell--number">27</td>
            <td class="cell--number">7</td>
            <td class="cell--number">1.71</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1744bd46cd4e8aee67df4b1e7e7b0f6dd745175f" class="src_link" title="app/controllers/blocks_controller.rb">app/controllers/blocks_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">87.18 %</td>
            <td class="cell--number">67</td>
            <td class="cell--number">39</td>
            <td class="cell--number">34</td>
            <td class="cell--number">5</td>
            <td class="cell--number">3.67</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#fd7707f9b9d4ef175c11c4df3e1bb6c029a674b8" class="src_link" title="app/controllers/courses_controller.rb">app/controllers/courses_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">89.80 %</td>
            <td class="cell--number">259</td>
            <td class="cell--number">98</td>
            <td class="cell--number">88</td>
            <td class="cell--number">10</td>
            <td class="cell--number">3.33</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ba3e8706daedc3261b2a329430c34ef324a556f7" class="src_link" title="app/controllers/excel_files_controller.rb">app/controllers/excel_files_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">86.96 %</td>
            <td class="cell--number">89</td>
            <td class="cell--number">23</td>
            <td class="cell--number">20</td>
            <td class="cell--number">3</td>
            <td class="cell--number">1.48</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#4ee89e87d84f30fe4bec31e3d8d1c62b24330409" class="src_link" title="app/controllers/pages_controller.rb">app/controllers/pages_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">14</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.57</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f17b9a788ed7e2fd952532270bb4e3b71702ccdd" class="src_link" title="app/controllers/registrations_controller.rb">app/controllers/registrations_controller.rb</a></td>
            <td class="red strong cell--number t-file__coverage">59.46 %</td>
            <td class="cell--number">81</td>
            <td class="cell--number">37</td>
            <td class="cell--number">22</td>
            <td class="cell--number">15</td>
            <td class="cell--number">0.97</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b06eedc52fb7dd610954e20a8c118fa874a7effc" class="src_link" title="app/controllers/schedules_controller.rb">app/controllers/schedules_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">31</td>
            <td class="cell--number">14</td>
            <td class="cell--number">14</td>
            <td class="cell--number">0</td>
            <td class="cell--number">2.14</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#0b4b129d7396ed0cbbd9b51eb7ddbbc8fa68fee3" class="src_link" title="app/controllers/sessions_controller.rb">app/controllers/sessions_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">40</td>
            <td class="cell--number">21</td>
            <td class="cell--number">21</td>
            <td class="cell--number">0</td>
            <td class="cell--number">13.57</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b2da450e91f29cbb10981b98a229a95377807d5b" class="src_link" title="app/controllers/students_controller.rb">app/controllers/students_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">4</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#76579a1868307efbe7ce2cb73de959f0ce2d5114" class="src_link" title="app/controllers/users_controller.rb">app/controllers/users_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage">91.67 %</td>
            <td class="cell--number">61</td>
            <td class="cell--number">36</td>
            <td class="cell--number">33</td>
            <td class="cell--number">3</td>
            <td class="cell--number">1.14</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Channels">
  <h2>
    <span class="group_name">Channels</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Channels"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Models">
  <h2>
    <span class="group_name">Models</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Models"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Mailers">
  <h2>
    <span class="group_name">Mailers</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Mailers"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Helpers">
  <h2>
    <span class="group_name">Helpers</span>
    (<span class="covered_percent">
      <span class="green">
  97.62%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         7.33
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Helpers"></a>

  <div>
    <b>5</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>42</b> relevant lines,
    <span class="green"><b>41</b> lines covered</span> and
    <span class="red"><b>1</b> lines missed. </span>
    (<span class="green">
  97.62%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1ebedd0199ef60b64c6fcb59d71a3435b3ff34d7" class="src_link" title="app/helpers/admin_helper.rb">app/helpers/admin_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">2</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f6db2153ee565191c070b0ee3d03cbeb357cfe72" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">32</td>
            <td class="cell--number">6</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0</td>
            <td class="cell--number">28.33</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#24df8333f0932949741d0f4da5dbdd1ebbc5b52d" class="src_link" title="app/helpers/blocks_helper.rb">app/helpers/blocks_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">2</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6a60a409c59d3a0a98e3280d1ad4f05350d186a2" class="src_link" title="app/helpers/courses_helper.rb">app/helpers/courses_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.67 %</td>
            <td class="cell--number">86</td>
            <td class="cell--number">30</td>
            <td class="cell--number">29</td>
            <td class="cell--number">1</td>
            <td class="cell--number">4.33</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#eb01fc174b864de452fa139400b3de723c103dc2" class="src_link" title="app/helpers/excel_files_helper.rb">app/helpers/excel_files_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">6</td>
            <td class="cell--number">4</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.50</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Jobs">
  <h2>
    <span class="group_name">Jobs</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Jobs"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Libraries">
  <h2>
    <span class="group_name">Libraries</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="red">
         0.0
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Libraries"></a>

  <div>
    <b>0</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>0</b> relevant lines,
    <span class="green"><b>0</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="Ungrouped">
  <h2>
    <span class="group_name">Ungrouped</span>
    (<span class="covered_percent">
      <span class="green">
  94.19%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         6.57
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Ungrouped"></a>

  <div>
    <b>2</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>86</b> relevant lines,
    <span class="green"><b>81</b> lines covered</span> and
    <span class="red"><b>5</b> lines missed. </span>
    (<span class="green">
  94.19%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c045af345a201725bfed6c63ed8ab504fab1a86e" class="src_link" title="app/services/file_parser.rb">app/services/file_parser.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.83 %</td>
            <td class="cell--number">105</td>
            <td class="cell--number">63</td>
            <td class="cell--number">61</td>
            <td class="cell--number">2</td>
            <td class="cell--number">8.65</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#207254e2f5a3c3df57a3bcdfc3ee5d5a237cbfa7" class="src_link" title="app/services/user_service.rb">app/services/user_service.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">86.96 %</td>
            <td class="cell--number">48</td>
            <td class="cell--number">23</td>
            <td class="cell--number">20</td>
            <td class="cell--number">3</td>
            <td class="cell--number">0.87</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>

        
      </div>

      <div id="footer">
        Generated by <a href="https://github.com/simplecov-ruby/simplecov">simplecov</a> v0.22.0
        and simplecov-html v0.13.1<br/>
        using Cucumber Features, RSpec
      </div>

      <div class="source_files">
      
        <div class="source_table" id="b1476ae8c4c7df269f972cd2507eef05a222ead5">
  <div class="header">
    <h3>app/controllers/admin_controller.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># app/controllers/admin_controller.rb</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class AdminController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  before_action :require_admin</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def dashboard</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            

            <code class="ruby">    # dashboard logic here</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="68472b3a551b422be54cd4fd7a9ef9288a2df1af">
  <div class="header">
    <h3>app/controllers/application_controller.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>9</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="1">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">class ApplicationController &lt; ActionController::Base</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="2">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  allow_browser versions: :modern</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="3">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  helper_method :current_user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="6">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="8">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def current_user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="284" data-linenumber="9">
            
              <span class="hits">284</span>
            

            

            <code class="ruby">    @current_user ||= User.find(session[:user_id]) if session[:user_id]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="13">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def require_admin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="47" data-linenumber="14">
            
              <span class="hits">47</span>
            

            

            <code class="ruby">    unless current_user&amp;.admin?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="15">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">      redirect_to login_path, alert: &quot;You don&#39;t have access to this page.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="3068302ea59124c2eaead910c9c4d5767478955c">
  <div class="header">
    <h3>app/controllers/block_selections_controller.rb</h3>
    <h4>
      <span class="red">
  79.41%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>34</b> relevant lines.
      <span class="green"><b>27</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="1">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">class BlockSelectionsController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="2">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  before_action :ensure_student</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="4">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def create</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="5">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    selected_ids = params.dig(:block, :selected_block_ids)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="6">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    if selected_ids.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="7">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      flash[:alert] = &quot;No block was selected. Please select a block.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="8">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      redirect_back fallback_location: blocks_path and return</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="9">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    elsif selected_ids.size &gt; 1</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:alert] = &quot;Please only select one block.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_back fallback_location: blocks_path and return</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="14">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    selected_block_id = selected_ids.first.to_s</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="15">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    courses_hash = params[:block][:courses] || {}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="16">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    courses_hash = courses_hash.transform_keys(&amp;:to_s)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="17">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    courses_for_selected = courses_hash[selected_block_id]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="19">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if courses_for_selected.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            

            

            <code class="ruby">      flash[:alert] = &quot;No courses found for the selected block.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="21">
            

            

            <code class="ruby">      redirect_back fallback_location: blocks_path and return</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="24">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    block_instance = Block.new(courses_for_selected)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="26">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if request.format.json?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby">      # Handle AJAX requests</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            

            

            <code class="ruby">      if block_instance.valid?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="29">
            

            

            <code class="ruby">        current_user.create_block_selection!(course_ids: block_instance.courses.map(&amp;:id))</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            

            

            <code class="ruby">        render json: { message: &quot;Block successfully selected.&quot; }, status: :ok</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            

            

            <code class="ruby">        render json: { message: &quot;Invalid block selection.&quot; }, status: :unprocessable_entity</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby">      # Handle non-AJAX requests</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="36">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      if block_instance.valid?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        current_user.create_block_selection!(course_ids: block_instance.courses.map(&amp;:id))</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        flash[:notice] = &quot;Block successfully selected.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        redirect_back fallback_location: blocks_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        flash[:alert] = &quot;Invalid block&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        redirect_back fallback_location: blocks_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby">  # def save_standalone</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            

            <code class="ruby">  #   selected_courses = params[:standalone_courses]&amp;.values</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            

            

            <code class="ruby">  #   if selected_courses.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby">  #     flash[:alert] = &quot;No standalone courses selected.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            

            <code class="ruby">  #     redirect_back fallback_location: blocks_path and return</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            

            <code class="ruby">  #   end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            

            

            <code class="ruby">  #   selected_courses.each do |course_id|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            

            

            <code class="ruby">  #     StandaloneCourse.find_or_create_by!(user_id: current_user.id, course_id: course_id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            

            

            <code class="ruby">  #   end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            

            

            <code class="ruby">  #   flash[:notice] = &quot;Standalone courses saved successfully.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            

            

            <code class="ruby">  #   redirect_back fallback_location: blocks_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            

            

            <code class="ruby">  # end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="63">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="65">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def ensure_student</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="66">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">    redirect_to root_path, alert: &quot;Access denied.&quot; unless current_user.student?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="69">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def block_params</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="70">
            

            

            <code class="ruby">    params.require(:block).permit(courses: {}, selected_block_ids: [])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1744bd46cd4e8aee67df4b1e7e7b0f6dd745175f">
  <div class="header">
    <h3>app/controllers/blocks_controller.rb</h3>
    <h4>
      <span class="yellow">
  87.18%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>39</b> relevant lines.
      <span class="green"><b>34</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="1">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">class BlocksController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby">  # before_action :require_admin</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby">  # skip_before_action :require_admin, if: -&gt; { Rails.env.test? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="5">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def index</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="6">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    @blocks = defined?(@@generated_blocks) ? @@generated_blocks : []</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="7">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    @generated_blocks = @blocks  # Keep this for backward compatibility if needed</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="8">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    @standalone_courses_group = defined?(@@standalone_courses_group) ? @@standalone_courses_group : {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby">    # puts &quot;Standalone courses grouped: #{@standalone_courses_group.inspect}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="10">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    render :index</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="13">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def generate</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="14">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    courses = Course.all</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            

            <code class="ruby">    # Filter courses whose base_course_code matches a normalized wanted code</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="16">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    normalized = params[:course_codes] || []</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="17">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    normalized_standalone = params[:standalone_courses] || []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="19">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    selected_courses_sections = courses</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="20">
            
              <span class="hits">18</span>
            

            

            <code class="ruby">      .select { |course| normalized.include?(course.base_course_code.upcase) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="22">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    puts &quot;Selected course count: #{selected_courses_sections.length}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="23">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    puts &quot;Selected courses: #{selected_courses_sections.map(&amp;:sec_name).join(&#39;, &#39;)}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="24">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    @@generated_blocks = Block.generate_blocks(selected_courses_sections)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="26">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    standalone_courses_sections = courses</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="27">
            
              <span class="hits">18</span>
            

            

            <code class="ruby">    .select { |course| normalized_standalone.include?(course.base_course_code.upcase) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="29">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    @@standalone_courses_group = standalone_courses_grouped(standalone_courses_sections)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="30">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    redirect_to blocks_path, notice: &quot;Generated #{@@generated_blocks.length} blocks! Review the generated blocks.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="33">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def preview</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="34">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if defined?(@@generated_blocks)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @generated_blocks = @@generated_blocks</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      render :preview</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to blocks_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="42">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def export</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="43">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @blocks = defined?(@@generated_blocks) ? @@generated_blocks : []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="45">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="46">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">      format.html { redirect_to blocks_path }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="47">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      format.xlsx {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="48">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">        response.headers[&quot;Content-Disposition&quot;] = &#39;attachment; filename=&quot;course_blocks.xlsx&quot;&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="49">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">        render xlsx: &quot;export&quot;, locals: { blocks: @blocks }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="55">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def standalone_courses_grouped(courses)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="56">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    courses.group_by { |course| course.base_course_code.upcase }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="59">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def options_from_collection_for_select(collection, value_method, label_method, selected = nil)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="60">
            

            

            <code class="ruby">    collection.map do |item|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="61">
            

            

            <code class="ruby">      value = item.public_send(value_method)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="62">
            

            

            <code class="ruby">      label = label_method.respond_to?(:call) ? label_method.call(item) : item.public_send(label_method)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="63">
            

            

            <code class="ruby">      selected_attr = selected.to_s == value.to_s ? &quot; selected&quot; : &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="64">
            

            

            <code class="ruby">      &quot;&lt;option value=\&quot;#{ERB::Util.html_escape(value)}\&quot;#{selected_attr}&gt;#{ERB::Util.html_escape(label)}&lt;/option&gt;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            

            

            <code class="ruby">    end.join.html_safe</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="fd7707f9b9d4ef175c11c4df3e1bb6c029a674b8">
  <div class="header">
    <h3>app/controllers/courses_controller.rb</h3>
    <h4>
      <span class="yellow">
  89.8%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>98</b> relevant lines.
      <span class="green"><b>88</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="1">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">require &quot;time&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="3">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">class CoursesController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="4">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  include CoursesHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            

            <code class="ruby">  # before_action :authenticate_user!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            

            <code class="ruby">  # before_action :admin_only, only: [:upload, :new, :create, :edit, :update, :destroy]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="7">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  before_action :set_course, only: %i[ show edit update destroy ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby">  # GET /courses or /courses.json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="10">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def index</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="11">
            
              <span class="hits">9</span>
            

            

            <code class="ruby">    @courses = Course.all.order(:sec_name)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="12">
            
              <span class="hits">9</span>
            

            

            <code class="ruby">    @excel_files = ExcelFile.all</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby">    # @course = Course.new</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="14">
            
              <span class="hits">9</span>
            

            

            <code class="ruby">    @excel_file = ExcelFile.new</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="15">
            
              <span class="hits">9</span>
            

            

            <code class="ruby">    @prerequisites = {}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="16">
            
              <span class="hits">9</span>
            

            

            <code class="ruby">    @corequisites = {}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="17">
            
              <span class="hits">9</span>
            

            

            <code class="ruby">    @categories = {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="20">
            
              <span class="hits">9</span>
            

            

            <code class="ruby">    @courses.each do |course|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="21">
            
              <span class="hits">24</span>
            

            

            <code class="ruby">      if course.prerequisites.present?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        @prerequisites[course.sec_name] = course.prerequisites.split(&quot;, &quot;).map(&amp;:strip)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="24">
            
              <span class="hits">24</span>
            

            

            <code class="ruby">      if course.corequisites.present?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            

            

            <code class="ruby">        @corequisites[course.sec_name] = course.corequisites.split(&quot;, &quot;).map(&amp;:strip)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            

            

            <code class="ruby">  # GET /courses/1 or /courses/1.json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="31">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def show</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="32">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @prerequisites = @course.prerequisites&amp;.split(&quot;, &quot;)&amp;.map(&amp;:strip)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby">  # POST /courses or /courses.json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="36">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def create</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="37">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    @course = Course.new(course_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="39">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">    if @course.save</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="40">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      flash[:notice] = &quot;#{@course.short_title} was successfully created.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="41">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      redirect_to courses_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="43">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      flash.now[:alert] = @course.errors.full_messages.join(&quot;, &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="44">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      render :new, status: :unprocessable_entity</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            

            <code class="ruby">  # PATCH/PUT /courses/1 or /courses/1.json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="49">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def update</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="50">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    if @course.update(course_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="51">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      flash[:notice] = &quot;#{@course.short_title} was successfully updated.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="52">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      redirect_to course_path(@course)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash.now[:alert] = @course.errors.full_messages.join(&quot;, &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      render :edit, status: :unprocessable_entity</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            

            

            <code class="ruby">  # DELETE /courses/1 or /courses/1.json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="60">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def destroy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="61">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @course = Course.find(params[:id])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="62">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @course.destroy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="63">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    flash[:notice] = &quot;Course was successfully deleted&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="64">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    redirect_to courses_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="67">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def upload_courses_by_excel</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="68">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    uploaded_file = params[:file]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="69">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    as_id = params[:as_id] || SecureRandom.uuid</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="71">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    unless uploaded_file</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="72">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:alert] = &quot;No file uploaded.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      puts &quot; No file uploaded&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="74">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to courses_path and return</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="77">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    puts &quot; Uploading file: #{uploaded_file.original_filename}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="78">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    puts &quot; Assigned as_id: #{as_id}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="80">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    spreadsheet = Roo::Excelx.new(uploaded_file.path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="81">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    sheet = spreadsheet.sheet(0)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="82">
            
              <span class="hits">14</span>
            

            

            <code class="ruby">    headers = sheet.row(1).map { |h| h.to_s.strip.gsub(&quot;\n&quot;, &quot; &quot;) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="84">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    puts &quot; Headers: #{headers.inspect}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="86">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    inserted = 0</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="87">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    failed_rows = []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="89">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    (2..sheet.last_row).each do |i|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="90">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      row_data = Hash[[headers, sheet.row(i)].transpose]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="91">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      puts &quot; Row #{i}: #{row_data.inspect}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="94">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      parsed_start, parsed_end = get_parsed_times(row_data[&quot;Start Time&quot;], row_data[&quot;End Time&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="96">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      if row_data[&quot;Sec Name&quot;]&amp;.strip == &quot;CHEM 1109&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="97">
            

            

            <code class="ruby">        puts &quot; Matched CHEM 1109 @ Row #{i}: #{row_data.inspect}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="98">
            

            

            <code class="ruby">        puts &quot; Start Time: #{parsed_start}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="99">
            

            

            <code class="ruby">        puts &quot; End Time: #{parsed_end}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="102">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      if row_data[&quot;Sec Name&quot;]&amp;.strip == &quot;CHEM-1109-001&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="103">
            

            

            <code class="ruby">        puts &quot; Matched CHEM-1109-001 @ Row #{i}: #{row_data.inspect}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="104">
            

            

            <code class="ruby">        puts &quot; Start Time: #{parsed_start}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="105">
            

            

            <code class="ruby">        puts &quot; End Time: #{parsed_end}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="107">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="108">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="109">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      course = Course.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            

            

            <code class="ruby">        term: row_data[&quot;Term&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            

            

            <code class="ruby">        dept_code: row_data[&quot;Dept Code&quot;]&amp;.strip,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            

            

            <code class="ruby">        course_id: row_data[&quot;Crse Id&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="113">
            

            

            <code class="ruby">        sec_coreq_secs: row_data[&quot;Coreq Secs&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="114">
            

            

            <code class="ruby">        syn: row_data[&quot;Syn&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="115">
            

            

            <code class="ruby">        sec_name: row_data[&quot;Sec Name&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            

            

            <code class="ruby">        short_title: row_data[&quot;Short Title&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="117">
            

            

            <code class="ruby">        im: row_data[&quot;IM&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="118">
            

            

            <code class="ruby">        building: row_data[&quot;Bldg&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="119">
            

            

            <code class="ruby">        room: row_data[&quot;Room&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            

            

            <code class="ruby">        days: row_data[&quot;Days&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            

            

            <code class="ruby">        start_time: parsed_start,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="122">
            

            

            <code class="ruby">        end_time: parsed_end,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="123">
            

            

            <code class="ruby">        fac_id: row_data[&quot;Fac ID&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="124">
            

            

            <code class="ruby">        faculty_name: row_data[&quot;Faculty Name&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="125">
            

            

            <code class="ruby">        crs_capacity: row_data[&quot;Crs Capacity&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="126">
            

            

            <code class="ruby">        sec_cap: row_data[&quot;Sec Cap&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="127">
            

            

            <code class="ruby">        student_count: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="128">
            

            

            <code class="ruby">        notes: row_data[&quot;NOTES&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="129">
            

            

            <code class="ruby">        prerequisites: nil,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="130">
            

            

            <code class="ruby">        corequisites: nil,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="131">
            

            

            <code class="ruby">        category: nil,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="132">
            

            

            <code class="ruby">        as_id: as_id</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="133">
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="134">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="135">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      if course.save</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="136">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">        inserted += 1</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="137">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">        puts &quot; Inserted: #{course.sec_name} (row #{i})&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="138">
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="139">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        error_message = course.errors.full_messages.join(&quot;, &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="140">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        puts &quot; Failed row #{i}: #{error_message}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="141">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        failed_rows &lt;&lt; { row: i, errors: course.errors.full_messages }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="142">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="143">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="144">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="145">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    puts &quot; Upload complete. Inserted: #{inserted}, Failed: #{failed_rows.size}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="146">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="147">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    flash[:notice] = &quot;#{inserted} courses uploaded successfully.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="148">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    flash[:alert] = &quot;Some rows failed to upload: #{failed_rows.inspect}&quot; if failed_rows.any?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="149">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    redirect_to courses_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="150">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="151">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="152">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def parse_time_value(t)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="153">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">    return nil if t.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="154">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="155">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">    t = t.to_s.strip</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="156">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="157">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">    if t =~ /^\d+$/  # If it&#39;s all digits, assume it&#39;s seconds</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="158">
            

            

            <code class="ruby">      seconds = t.to_i</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="159">
            

            

            <code class="ruby">      Time.at(seconds).utc.strftime(&quot;%I:%M %p&quot;) # e.g., 50400 =&gt; &quot;02:00 PM&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="160">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="161">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">      Time.parse(t).strftime(&quot;%I:%M %p&quot;) rescue t</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="162">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="163">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="164">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="165">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def get_parsed_times(start_time_raw, end_time_raw)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="166">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">    start_times = start_time_raw.to_s.split(/\n+/).map { |t| parse_time_value(t) }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="167">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">    end_times   = end_time_raw.to_s.split(/\n+/).map { |t| parse_time_value(t) }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="168">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="169">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    parsed_start = start_times.min</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="170">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    parsed_end   = end_times.max</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="171">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="172">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    [parsed_start, parsed_end]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="173">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="174">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="175">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="176">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def new</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="177">
            

            

            <code class="ruby">    @course = Course.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="178">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="179">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="180">
            

            

            <code class="ruby">  # show recently uploaded courses</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="181">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def show_by_upload</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="182">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    as_id = params[:as_id]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="183">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    validate_courses(as_id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="184">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @courses = Course.where(as_id: as_id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="185">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="186">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="187">
            

            

            <code class="ruby">  # Gets the course code from the sec_name (e.g. MATH-2414 from MATH-2414-007)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="188">
            

            

            <code class="ruby">  # def extract_base_code(sec_name)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="189">
            

            

            <code class="ruby">  #   standardized = sec_name.gsub(&#39; &#39;, &#39;-&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="190">
            

            

            <code class="ruby">  #   parts = standardized.split(&#39;-&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="191">
            

            

            <code class="ruby">  #   &quot;#{parts[0]}-#{parts[1]}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="192">
            

            

            <code class="ruby">  # end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="193">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="194">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="195">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="196">
            

            

            <code class="ruby">  # Define prereqs and coreqs for listed courses for populating columns during creation</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="197">
            

            

            <code class="ruby">  # def corequisites</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="198">
            

            

            <code class="ruby">  #   {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="199">
            

            

            <code class="ruby">  #     &#39;ENGR 102&#39; =&gt; %w[MATH-2412 MATH-2413],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="200">
            

            

            <code class="ruby">  #     &#39;ENGR 216&#39; =&gt; [&#39;PHYS 2425&#39;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="201">
            

            

            <code class="ruby">  #     &#39;ENGR 217&#39; =&gt; [&#39;PHYS 2426&#39;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="202">
            

            

            <code class="ruby">  #   }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="203">
            

            

            <code class="ruby">  # end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="204">
            

            

            <code class="ruby">  # def prerequisites</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="205">
            

            

            <code class="ruby">  #   {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="206">
            

            

            <code class="ruby">  #     &#39;MATH-2413&#39; =&gt; [&#39;MATH-2412&#39;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="207">
            

            

            <code class="ruby">  #     &#39;MATH-2414&#39; =&gt; [&#39;MATH-2413&#39;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="208">
            

            

            <code class="ruby">  #     &#39;MATH-2415&#39; =&gt; [&#39;MATH-2414&#39;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="209">
            

            

            <code class="ruby">  #     &#39;MATH-2420&#39; =&gt; [&#39;MATH-2415&#39;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="210">
            

            

            <code class="ruby">  #     &#39;ENGR-216&#39; =&gt; %w[ENGR-102 MATH-2413],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="211">
            

            

            <code class="ruby">  #     &#39;ENGR-217&#39; =&gt; %w[ENGR-216 PHYS-2425 MATH-2414],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="212">
            

            

            <code class="ruby">  #     &#39;CHEM-1312&#39; =&gt; [&#39;CHEM-1309&#39;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="213">
            

            

            <code class="ruby">  #     &#39;CHEM-1112&#39; =&gt; [&#39;CHEM-1309&#39;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="214">
            

            

            <code class="ruby">  #     &#39;PHYS-2425&#39; =&gt; [&#39;MATH-2413&#39;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="215">
            

            

            <code class="ruby">  #     &#39;PHYS-2426&#39; =&gt; %w[MATH-2414 PHYS-2425]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="216">
            

            

            <code class="ruby">  #   }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="217">
            

            

            <code class="ruby">  # end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="218">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="219">
            

            

            <code class="ruby">  # Use callbacks to share common setup or constraints between actions.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="220">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def set_course</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="221">
            
              <span class="hits">8</span>
            

            

            <code class="ruby">    @course = Course.find(params[:id])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="222">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="223">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="224">
            

            

            <code class="ruby">    # Only allow a list of trusted parameters through.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="225">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    def course_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="226">
            
              <span class="hits">7</span>
            

            

            <code class="ruby">      params.require(:course).permit(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="227">
            

            

            <code class="ruby">        :term,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="228">
            

            

            <code class="ruby">        :dept_code,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="229">
            

            

            <code class="ruby">        :course_id,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="230">
            

            

            <code class="ruby">        :sec_coreq_secs,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="231">
            

            

            <code class="ruby">        :syn,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="232">
            

            

            <code class="ruby">        :sec_name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="233">
            

            

            <code class="ruby">        :short_title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="234">
            

            

            <code class="ruby">        :im,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="235">
            

            

            <code class="ruby">        :building,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="236">
            

            

            <code class="ruby">        :room,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="237">
            

            

            <code class="ruby">        :days,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="238">
            

            

            <code class="ruby">        :start_time,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="239">
            

            

            <code class="ruby">        :end_time,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="240">
            

            

            <code class="ruby">        :fac_id,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="241">
            

            

            <code class="ruby">        :faculty_name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="242">
            

            

            <code class="ruby">        :crs_capacity,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="243">
            

            

            <code class="ruby">        :sec_cap,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="244">
            

            

            <code class="ruby">        :student_count,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="245">
            

            

            <code class="ruby">        :notes,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="246">
            

            

            <code class="ruby">        :as_id,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="247">
            

            

            <code class="ruby">        :prerequisites,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="248">
            

            

            <code class="ruby">        :corequisites,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="249">
            

            

            <code class="ruby">        :category</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="250">
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="251">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="252">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="253">
            

            

            <code class="ruby">  # def admin_only</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="254">
            

            

            <code class="ruby">  #   unless current_user.admin?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="255">
            

            

            <code class="ruby">  #     flash[:alert] = &quot;User is not authorized to perform this action.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="256">
            

            

            <code class="ruby">  #     redirect_to courses_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="257">
            

            

            <code class="ruby">  #   end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="258">
            

            

            <code class="ruby">  # end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="259">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ba3e8706daedc3261b2a329430c34ef324a556f7">
  <div class="header">
    <h3>app/controllers/excel_files_controller.rb</h3>
    <h4>
      <span class="yellow">
  86.96%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>23</b> relevant lines.
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;../services/file_parser&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class ExcelFilesController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  include Rails.application.routes.url_helpers</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  include ExcelFilesHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  before_action :set_excel_file, only: %i[ show edit update destroy ]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  rescue_from ActiveRecord::RecordNotFound, with: :handle_record_not_found</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby">  # GET /excel_files or /excel_files.json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def index</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @excel_files = ExcelFile.all</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            

            <code class="ruby">  # GET /excel_files/1 or /excel_files/1.json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def show</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            

            

            <code class="ruby">    @attachment_url = helpers.attachment_url(@excel_file.file)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby">  # GET /excel_files/new</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def new</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="21">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @excel_file = ExcelFile.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            

            <code class="ruby">  # GET /excel_files/1/edit</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def edit</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby">  # POST /excel_files or /excel_files.json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def create</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @excel_file = ExcelFile.new(excel_file_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      if @excel_file.save</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="33">
            

            

            <code class="ruby">        format.html { redirect_to @excel_file, notice: &quot;Excel file was successfully uploaded and saved.&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            

            

            <code class="ruby">        format.json { render :show, status: :created, location: @excel_file }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        flash[:notice] = &quot;Courses not added to database.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="37">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">        format.html { render :new, status: :unprocessable_entity }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        format.json { render json: @excel_file.errors, status: :unprocessable_entity }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      add_courses_to_database(@excel_file, @excel_file.id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="44">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # :nocov:</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="45">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="46">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # PATCH/PUT /excel_files/1 or /excel_files/1.json</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="47">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  def update</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="48">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="49">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">      if @excel_file.update(excel_file_params)</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="50">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">        format.html { redirect_to @excel_file, notice: &quot;Excel file was successfully updated.&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="51">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">        format.json { render :show, status: :ok, location: @excel_file }</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="52">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="53">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">        format.html { render :edit, status: :unprocessable_entity }</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="54">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">        format.json { render json: @excel_file.errors, status: :unprocessable_entity }</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="55">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="56">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="57">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="58">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="59">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # DELETE /excel_files/1 or /excel_files/1.json</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="60">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  def destroy</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="61">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    @excel_file.destroy!</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="62">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="63">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="64">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">      format.html { redirect_to excel_files_path, status: :see_other, notice: &quot;Excel file was successfully destroyed.&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="65">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">      format.json { head :no_content }</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="66">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="67">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="68">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="69">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="70">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="71">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # Use callbacks to share common setup or constraints between actions.</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="72">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  def set_excel_file</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="73">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    @excel_file = ExcelFile.find(params[:id])</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="74">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="75">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="76">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # Only allow a list of trusted parameters through.</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="77">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  def excel_file_params</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="78">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    params.require(:excel_file).permit(:name, :file)</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="79">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="80">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="81">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # Handle RecordNotFound exception</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="82">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  def handle_record_not_found</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="83">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="2" data-linenumber="84">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">      format.html { redirect_to excel_files_path, alert: &quot;Excel file not found.&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="85">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">      format.json { render json: { error: &quot;Excel file not found.&quot; }, status: :not_found }</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="86">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="87">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="88">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # :nocov:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="4ee89e87d84f30fe4bec31e3d8d1c62b24330409">
  <div class="header">
    <h3>app/controllers/pages_controller.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># /app/controllers/pages_controller.rb</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class PagesController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  include ApplicationHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def index</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="7">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @logged_in = check_user_status!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def check_user_status!</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="12">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    user_signed_in? ? true : false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f17b9a788ed7e2fd952532270bb4e3b71702ccdd">
  <div class="header">
    <h3>app/controllers/registrations_controller.rb</h3>
    <h4>
      <span class="red">
  59.46%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>37</b> relevant lines.
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>15</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class RegistrationsController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  include CoursesHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def create</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            

            <code class="ruby">    registration_data = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      year: params[:year],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby">      math_course_taken: params[:math_course].presence,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby">      science_course_taken: params[:science_course].presence,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby">      engineering_course_taken: params[:engineering_course].presence,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby">      wanted_math_course: params[:wanted_math_course].presence,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            

            

            <code class="ruby">      wanted_science_course: params[:wanted_science_course].presence,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby">      wanted_engineering_course: params[:wanted_engineering_course].presence</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            

            <code class="ruby">    taken_courses = [</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      registration_data[:math_course_taken],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            

            

            <code class="ruby">      registration_data[:science_course_taken],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby">      registration_data[:engineering_course_taken]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby">    ].compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby">    wanted_courses = [</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      registration_data[:wanted_math_course],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby">      registration_data[:wanted_science_course],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            

            <code class="ruby">      registration_data[:wanted_engineering_course]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby">    ].compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    failed = []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    wanted_courses.each do |sec_name|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="30">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      base = extract_base_code(sec_name)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            

            <code class="ruby">      # --- Prereq Validation ---</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="33">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      unmet_prereqs = (prerequisites[base] || []).reject do |pr|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            

            

            <code class="ruby">        taken_courses.any? { |taken| course_satisfies?(taken, pr) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            

            <code class="ruby">      # --- Coreq Validation ---</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="38">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      unmet_coreqs = (corequisites[base] || []).reject do |coreq|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            

            

            <code class="ruby">        taken_courses.any? { |taken| course_satisfies?(taken, coreq) } ||</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="40">
            

            

            <code class="ruby">        wanted_courses.any? { |w| course_satisfies?(w, coreq) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="43">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      unless unmet_prereqs.empty? &amp;&amp; unmet_coreqs.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="44">
            

            

            <code class="ruby">        failed &lt;&lt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            

            

            <code class="ruby">          course: sec_name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            

            <code class="ruby">          missing_prereqs: unmet_prereqs,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby">          missing_coreqs: unmet_coreqs</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="52">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    if failed.any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="53">
            

            

            <code class="ruby">      flash[:error] = failed.map do |f|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="54">
            

            

            <code class="ruby">        errors = []</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="55">
            

            

            <code class="ruby">        errors &lt;&lt; &quot;prerequisites: #{f[:missing_prereqs].join(&#39;, &#39;)}&quot; if f[:missing_prereqs].any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="56">
            

            

            <code class="ruby">        errors &lt;&lt; &quot;corequisites: #{f[:missing_coreqs].join(&#39;, &#39;)}&quot; if f[:missing_coreqs].any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="57">
            

            

            <code class="ruby">        &quot;#{f[:course]} (missing #{errors.join(&#39;; &#39;)})&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            

            

            <code class="ruby">      end.join(&quot;; &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="59">
            

            

            <code class="ruby">      redirect_to register_path and return</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      flash[:notice] = &quot;Successfully registered for: #{wanted_courses.join(&#39;, &#39;)}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="62">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">      normalized = wanted_courses.map { |name| name.strip.upcase }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="63">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">      normalized_standalone = normalized.select { |name| standalone_courses.include?(name) }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="64">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      normalized -= normalized_standalone</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="65">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      puts &quot;Normalized base codes: #{normalized.inspect}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="66">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      puts &quot;Standalone base codes: #{normalized_standalone.inspect}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="67">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to generate_blocks_path(course_codes: normalized, standalone_courses: normalized_standalone) and return</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="71">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def course_satisfies?(taken_sec_name, required_base)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="74">
            

            

            <code class="ruby">    taken = extract_base_code(taken_sec_name)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="75">
            

            

            <code class="ruby">    taken_dept, taken_num = taken.split(&quot;-&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="76">
            

            

            <code class="ruby">    req_dept, req_num = required_base.split(&quot;-&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="77">
            

            

            <code class="ruby">    return false unless taken_dept == req_dept</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="79">
            

            

            <code class="ruby">    taken_num.to_i &gt;= req_num.to_i</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b06eedc52fb7dd610954e20a8c118fa874a7effc">
  <div class="header">
    <h3>app/controllers/schedules_controller.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>14</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="1">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">class SchedulesController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="2">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def generate_schedule</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby">  # Mock course data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby">  @courses = [</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="5">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    { name: &quot;Introduction to Computer Science&quot;, instructor: &quot;Dr. Alice Smith&quot;, course_code: &quot;CS101&quot; },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            

            <code class="ruby">    { name: &quot;Data Structures&quot;, instructor: &quot;Dr. Mark Lee&quot;, course_code: &quot;CS202&quot; },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby">    { name: &quot;Operating Systems&quot;, instructor: &quot;Prof. Emily Johnson&quot;, course_code: &quot;CS301&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby">  ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="11">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  before_action :require_login</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="13">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def schedule_viewer</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="14">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if current_user.block_selection.present?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      block_course_ids = current_user.block_selection.course_ids</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      block_course_ids = []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="20">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    standalone_course_ids = StandaloneCourse.where(user_id: current_user.id).pluck(:course_id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="22">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    all_course_ids = block_course_ids + standalone_course_ids</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="23">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @selected_courses = Course.where(id: all_course_ids)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="26">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">  def require_login</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="27">
            
              <span class="hits">6</span>
            

            

            <code class="ruby">    unless current_user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to login_path, alert: &quot;Please log in to view your schedule.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="0b4b129d7396ed0cbbd9b51eb7ddbbc8fa68fee3">
  <div class="header">
    <h3>app/controllers/sessions_controller.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>21</b> relevant lines.
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class SessionsController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  skip_before_action only: [:omniauth]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  include ApplicationHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def logout</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    reset_session</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to root_path, notice: &quot;You are logged out.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def failure</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to root_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            

            <code class="ruby">  # GET /auth/google_oauth2/callback</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def omniauth</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="31" data-linenumber="16">
            
              <span class="hits">31</span>
            

            

            <code class="ruby">    auth = request.env[&quot;omniauth.auth&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="31" data-linenumber="17">
            
              <span class="hits">31</span>
            

            

            <code class="ruby">    email = auth[&quot;info&quot;][&quot;email&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby">    # Look up the user by email instead of creating a new one.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="31" data-linenumber="20">
            
              <span class="hits">31</span>
            

            

            <code class="ruby">    @user = User.find_by(email: email)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="31" data-linenumber="22">
            
              <span class="hits">31</span>
            

            

            <code class="ruby">    if @user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby">      # update the user&#39;s uid</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="24">
            
              <span class="hits">30</span>
            

            

            <code class="ruby">      @user.update(uid: auth[&quot;uid&quot;], provider: auth[&quot;provider&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="25">
            
              <span class="hits">30</span>
            

            

            <code class="ruby">      session[:user_id] = @user.id</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="27">
            
              <span class="hits">30</span>
            

            

            <code class="ruby">      Rails.logger.info &quot;Successful login for #{@user.email} via OmniAuth.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            

            <code class="ruby">      # Redirect based on user role</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="30">
            
              <span class="hits">30</span>
            

            

            <code class="ruby">      if current_user_admin?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="22" data-linenumber="31">
            
              <span class="hits">22</span>
            

            

            <code class="ruby">        redirect_to admin_dashboard_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="33">
            
              <span class="hits">8</span>
            

            

            <code class="ruby">        redirect_to students_dashboard_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      Rails.logger.warn &quot;Unauthorized login attempt with email #{email}.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      redirect_to root_path, alert: &quot;Login failed. Your email address: #{email} is not authorized to access this application.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b2da450e91f29cbb10981b98a229a95377807d5b">
  <div class="header">
    <h3>app/controllers/students_controller.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class StudentsController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def dashboard</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="76579a1868307efbe7ce2cb73de959f0ce2d5114">
  <div class="header">
    <h3>app/controllers/users_controller.rb</h3>
    <h4>
      <span class="green">
  91.67%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>36</b> relevant lines.
      <span class="green"><b>33</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class UsersController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  include ApplicationHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  before_action :require_admin, only: [:index, :show, :edit, :update, :destroy]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def index</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="6">
            
              <span class="hits">5</span>
            

            

            <code class="ruby">    @users = User.all</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def show</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="10">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    user_id = params[:id]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="11">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @user = User.find(user_id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def edit</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user = User.find(params[:id])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def profile</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user = User.find(current_user.id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def update</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user = User.find params[:id]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user.update!(user_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    flash[:notice] = &quot;#{@user.email} was successfully updated.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to user_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def upload</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    if params[:file].present?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      uploaded_file = params[:file]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @file_path = uploaded_file.original_filename</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            

            <code class="ruby">      begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        UserService.process_users_spreadsheet(uploaded_file)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        flash[:success] = &quot;Users have been uploaded successfully.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        redirect_to users_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby">      rescue =&gt; e</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            

            

            <code class="ruby">        flash[:error] = &quot;An error occurred while processing the file: #{e.message}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="40">
            

            

            <code class="ruby">        nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="43">
            

            

            <code class="ruby">      flash[:error] = &quot;No file selected or file is invalid.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            

            

            <code class="ruby">      nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def destroy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user = User.find(params[:id])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="50">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    @user.destroy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="51">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    redirect_to users_path, notice: &quot;User was successfully deleted.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def user_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    permitted = [:email, :first_name, :last_name, :uid, :provider]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    permitted &lt;&lt; :role if current_user.admin?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    params.require(:user).permit(permitted)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1ebedd0199ef60b64c6fcb59d71a3435b3ff34d7">
  <div class="header">
    <h3>app/helpers/admin_helper.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">module AdminHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f6db2153ee565191c070b0ee3d03cbeb357cfe72">
  <div class="header">
    <h3>app/helpers/application_helper.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>6</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">module ApplicationHelper</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="2">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # :nocov:</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="3">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  def attachment_url(attachment)</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="4">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    return test_attachment_url if Rails.env.test?</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="5">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    return default_attachment_url unless attachment.attached?</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="6">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="7">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    real_attachment_url(attachment)</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="8">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="9">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="10">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="11">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="12">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  def test_attachment_url</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="13">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    &quot;#&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="14">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="15">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="1" data-linenumber="16">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  def default_attachment_url</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="17">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    # Handle the case where attachment is not attached</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="0" data-linenumber="18">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">    &quot;/assets/default-attachment.png&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="19">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="skipped" data-hits="" data-linenumber="20">
            
              <span class="hits">skipped</span>
            

            

            <code class="ruby">  # :nocov:</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def real_attachment_url(attachment)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            

            <code class="ruby">    # Code to get the actual attachment URL for non-test environments</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def current_user_admin?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="89" data-linenumber="26">
            
              <span class="hits">89</span>
            

            

            <code class="ruby">    current_user&amp;.admin?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def user_signed_in?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="73" data-linenumber="30">
            
              <span class="hits">73</span>
            

            

            <code class="ruby">    !current_user.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="24df8333f0932949741d0f4da5dbdd1ebbc5b52d">
  <div class="header">
    <h3>app/helpers/blocks_helper.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">module BlocksHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="6a60a409c59d3a0a98e3280d1ad4f05350d186a2">
  <div class="header">
    <h3>app/helpers/courses_helper.rb</h3>
    <h4>
      <span class="green">
  96.67%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>30</b> relevant lines.
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">module CoursesHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def validate_courses(id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="3">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    as_id = id.to_i</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="4">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    return if Course.exists?(as_id: as_id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    flash[:error] = &quot;Courses not found: #{as_id}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def get_prerequisite_names(prerequisites)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="9">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    return &quot;None&quot; if prerequisites.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    prerequisites.split(&quot;,&quot;).map do |prereq|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="12">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      prereq.strip</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            

            <code class="ruby">    end.uniq.join(&quot;, &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            

            <code class="ruby">  # Gets the course code from the sec_name (e.g. MATH-2414 from MATH-2414-007)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def extract_base_code(sec_name)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="18">
            
              <span class="hits">15</span>
            

            

            <code class="ruby">    standardized = sec_name.gsub(&quot; &quot;, &quot;-&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="19">
            
              <span class="hits">15</span>
            

            

            <code class="ruby">    parts = standardized.split(&quot;-&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="20">
            
              <span class="hits">15</span>
            

            

            <code class="ruby">    &quot;#{parts[0]}-#{parts[1]}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            

            <code class="ruby">  # Get type of course from sec_name using extract_base_code (e.g. MATH from MATH-2414-007)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def extract_type(sec_name)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    base_code = extract_base_code(sec_name)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    parts = base_code.split(&quot;-&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    parts[0]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            

            

            <code class="ruby">  # Define prereqs and coreqs for listed courses for populating columns during creation</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def corequisites</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="34">
            
              <span class="hits">4</span>
            

            

            <code class="ruby">      &quot;ENGR-216&quot;  =&gt; [&quot;PHYS-2425&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby">      &quot;ENGR-217&quot;  =&gt; [&quot;PHYS-2426&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            

            

            <code class="ruby">      &quot;PHYS-2425&quot; =&gt; [&quot;MATH-2414&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            

            <code class="ruby">      &quot;PHYS-2426&quot; =&gt; [&quot;MATH-2415&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def prerequisites</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="44">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">      &quot;ENGR-102&quot;    =&gt; [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            

            

            <code class="ruby">      &quot;CLEN-181&quot;    =&gt; [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            

            <code class="ruby">      &quot;CLEN-261&quot;    =&gt; [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby">      &quot;CHEM-1309&quot;   =&gt; [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            

            <code class="ruby">      &quot;CHEM-1109&quot;   =&gt; [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            

            

            <code class="ruby">      &quot;CHEM-1311&quot;   =&gt; [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            

            

            <code class="ruby">      &quot;CHEM-1111&quot;   =&gt; [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby">      &quot;CHEM-1312&quot;   =&gt; [&quot;CHEM-1311&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            

            <code class="ruby">      &quot;CHEM-1112&quot;   =&gt; [&quot;CHEM-1111&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            

            <code class="ruby">      &quot;MATH-2413&quot;   =&gt; [&quot;MATH-2412&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            

            

            <code class="ruby">      &quot;MATH-2414&quot;   =&gt; [&quot;MATH-2413&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            

            

            <code class="ruby">      &quot;MATH-2415&quot;   =&gt; [&quot;MATH-2414&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            

            

            <code class="ruby">      &quot;MATH-2420&quot;   =&gt; [&quot;MATH-2415&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            

            

            <code class="ruby">      &quot;ENGR-216&quot;    =&gt; [&quot;ENGR-102&quot;, &quot;MATH-2413&quot;],  # (MATH-2413 or higher)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            

            

            <code class="ruby">      &quot;ENGR-217&quot;    =&gt; [&quot;ENGR-216&quot;, &quot;PHYS-2425&quot;, &quot;MATH-2414&quot;], # assumes prereqs not coreqs</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            

            

            <code class="ruby">      &quot;PHYS-2425&quot;   =&gt; [&quot;MATH-2413&quot;],  # co-enroll in MATH-2414 not enforced here</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            

            

            <code class="ruby">      &quot;PHYS-2426&quot;   =&gt; [&quot;PHYS-2425&quot;, &quot;MATH-2414&quot;] # assumes co-enrolled in MATH-2415</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            

            

            <code class="ruby">  # Define categories of courses based on class code</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="66">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def categories</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="68">
            

            

            <code class="ruby">      &quot;MATH&quot; =&gt; &quot;Math&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            

            

            <code class="ruby">      &quot;PHYS&quot; =&gt; &quot;Science&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            

            

            <code class="ruby">      &quot;CHEM&quot; =&gt; &quot;Science&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            

            

            <code class="ruby">      &quot;ENGR&quot; =&gt; &quot;Engineering&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            

            

            <code class="ruby">      &quot;CLEN&quot; =&gt; &quot;Intro&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="76">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def standalone_courses</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="77">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">     [&quot;CHEM-1311&quot;, &quot;CHEM-1312&quot;, &quot;PHYS-1401&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="80">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def distinct_courses_by_dept(dept_code)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="81">
            
              <span class="hits">16</span>
            

            

            <code class="ruby">    Course.where(&quot;dept_code LIKE ?&quot;, &quot;#{dept_code}%&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="82">
            
              <span class="hits">18</span>
            

            

            <code class="ruby">          .reject { |c| c.short_title =~ /\b(lb|lab)\b/i }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="83">
            
              <span class="hits">10</span>
            

            

            <code class="ruby">          .group_by { |c| extract_base_code(c.sec_name) }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="84">
            
              <span class="hits">8</span>
            

            

            <code class="ruby">          .map { |base, records| [&quot;#{base} - #{records.first.short_title}&quot;, base] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="eb01fc174b864de452fa139400b3de723c103dc2">
  <div class="header">
    <h3>app/helpers/excel_files_helper.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">module ExcelFilesHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def add_courses_to_database(file, id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="3">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    as_id = id</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="4">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    FileParser.new(file, as_id).parse</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c045af345a201725bfed6c63ed8ab504fab1a86e">
  <div class="header">
    <h3>app/services/file_parser.rb</h3>
    <h4>
      <span class="green">
  96.83%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>63</b> relevant lines.
      <span class="green"><b>61</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># app/services/file_parser.rb</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;stringio&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;roo&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;roo/formatters/xml&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;../models/course&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby"># File parser class. Takes in excel file of college classes to be put in database.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class FileParser</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :file_name, :term, :file, :as_id, :result</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  Result = Struct.new(:successful?, :errors)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(file, id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="14">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @result = Result.new(false, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="15">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    if file.is_a?(ExcelFile)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @file = ActiveStorage::Blob.find_by(id: id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="17">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    elsif file.is_a?(ActiveStorage::Blob)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @file = ActiveStorage::Blob.find_by(id: id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @file = file</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="22">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @as_id = id</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="23">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    set_file_name(file)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="24">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    @term = generate_term</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def parse</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="28">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    if @file.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      return Result.new(false, &quot;No file attachment found&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="31">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    if @file.is_a?(ActiveStorage::Blob)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      Tempfile.create([@file_name, &quot;xlsx&quot;]) do |temp_file|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        temp_file.binmode</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        temp_file.write(@file.download)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        temp_file.rewind</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        parse_xlsx(temp_file.path)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      parse_xlsx(@file.path)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def set_file_name(file)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="44">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    case file</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            

            

            <code class="ruby">    when ActiveStorage::Blob</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @file_name = file.filename.to_s</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby">    when ExcelFile</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @file_name = file.file.filename.to_s</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="50">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      @file_name = File.basename(file.to_s)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def parse_xlsx(file_path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="55">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    @as_id = 1 if @as_id.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            

            

            <code class="ruby">    begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="57">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      xlsx = Roo::Spreadsheet.open(file_path, extension: :xlsx)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="58">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      data = []</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="59">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      t = @term || &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="60">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      xlsx.each_with_index do |row, row_index|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="44" data-linenumber="61">
            
              <span class="hits">44</span>
            

            

            <code class="ruby">        next if row.empty? || row.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="44" data-linenumber="62">
            
              <span class="hits">44</span>
            

            

            <code class="ruby">        next if row_index == 0 || row[0].nil?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="63">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">        start_t, end_t, dept_code, course_id = get_parsed_values(row[0].to_s, row[7].to_s)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="64">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">        data &lt;&lt; { term: t, dept_code: dept_code, course_id: course_id, course: row[0], syn: row[1], instructor: row[2],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            

            

            <code class="ruby">                  location: row[3], room: row[4], days: row[6], start_time: start_t, end_time: end_t, as_id: @as_id }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="67">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      add_courses(data)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="68">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">      @result = Result.new(true, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            

            

            <code class="ruby">    rescue Exception</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="70">
            

            

            <code class="ruby">      if File.extname(@file_name) != &quot;.xlsx&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="71">
            

            

            <code class="ruby">        @result = Result.new(false, &quot;Invalid file format&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="76">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def generate_term</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="77">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    re = @file_name.match(/(?&lt;year&gt;\d{4})[_\s]+(?&lt;sem&gt;spring|fall)|(?&lt;sem2&gt;spring|fall)[_\s]+(?&lt;year2&gt;\d{4})/i)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="78">
            
              <span class="hits">3</span>
            

            

            <code class="ruby">    if re.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            

            

            <code class="ruby">      nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="81">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      year = re[:year].nil? ? re[:year2][2, 2] : re[:year][2, 2]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="82">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      sem = re[:sem].nil? ? re[:sem2][0, 1] : re[:sem][0, 1]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="83">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      &quot;2#{year}#{sem}000&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="87">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def get_parsed_values(course, time)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="88">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">    start_t = time.split(&quot;-&quot;)[0]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="89">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">    end_t = time.split(&quot;-&quot;)[1]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="90">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">    dept_code = course[/(chem|math|phys|clen|engr)/i] || &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="91">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">    course_id = course[/\d{3,4}/] || &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="92">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">    start_t.gsub(/[[:space:]]/, &quot;&quot;) unless start_t.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="93">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">    end_t.gsub(/[[:space:]]/, &quot;&quot;) unless end_t.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="94">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">    [start_t, end_t, dept_code, course_id]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="97">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def add_courses(data)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="98">
            
              <span class="hits">2</span>
            

            

            <code class="ruby">    data.each do |d|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="99">
            
              <span class="hits">38</span>
            

            

            <code class="ruby">      Course.where(term: d[:term], dept_code: d[:dept_code], course_id: d[:course_id], sec_coreq_secs: &quot;&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            

            

            <code class="ruby">                   syn: d[:syn], sec_name: d[:course], short_title: &quot;&quot;, im: &quot;&quot;, building: d[:building],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            

            

            <code class="ruby">                   room: d[:room], days: d[:days], start_time: d[:start_time], end_time: d[:end_time],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            

            

            <code class="ruby">                   crs_capacity: nil, sec_cap: nil, student_count: 0, notes: &quot;&quot;, as_id: d[:as_id]).first_or_create</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="103">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="207254e2f5a3c3df57a3bcdfc3ee5d5a237cbfa7">
  <div class="header">
    <h3>app/services/user_service.rb</h3>
    <h4>
      <span class="yellow">
  86.96%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>23</b> relevant lines.
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            

            <code class="ruby"># app/services/user_service.rb</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">class UserService</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">  def self.process_users_spreadsheet(file)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    spreadsheet = Roo::Excelx.new(file.path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    users = []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            

            <code class="ruby">    # Process from row 4 to the last row</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    (4..spreadsheet.last_row).each do |row|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            

            

            <code class="ruby">      # columns are combined_name, student_id, major, email, active</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      row_data = spreadsheet.row(row)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      combined_name = row_data[0]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      student_id    = row_data[1]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      major         = row_data[2]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      email         = row_data[3]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      active        = row_data[4]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            

            <code class="ruby">      # skip rows without email</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      next if email.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            

            <code class="ruby">      # format is last, first middle</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      if combined_name.present?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        name_parts = combined_name.split(&quot;,&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        last_name  = name_parts[0].strip</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">        first_name = name_parts[1]&amp;.strip || &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            

            

            <code class="ruby">        last_name  = &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            

            

            <code class="ruby">        first_name = &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            

            <code class="ruby">      # Create or update the user</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      user = User.find_or_initialize_by(email: email)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      user.assign_attributes(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            

            <code class="ruby">        first_name: first_name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            

            

            <code class="ruby">        last_name: last_name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            

            <code class="ruby">        student_id: student_id,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            

            <code class="ruby">        major: major,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            

            

            <code class="ruby">        role: &quot;student&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            

            <code class="ruby">        active: active,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            

            <code class="ruby">        uid: nil,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            

            <code class="ruby">        provider: nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">      users &lt;&lt; user</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            
              <span class="hits">1</span>
            

            

            <code class="ruby">    User.import users, on_duplicate_key_update: { conflict_target: [:email], columns: [:first_name, :last_name, :student_id, :major, :active, :role] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            

            

            <code class="ruby">  rescue StandardError =&gt; e</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="46">
            

            

            <code class="ruby">    raise &quot;Error processing spreadsheet: #{e.message}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
